<!DOCTYPE html>
<html lang='eng'>

<head>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0'>
    <meta http-equiv="x-ua-compatible" content='ie=edge'>
    <meta name='google-signin-client_id' content='568492347305-j8vnjb6h2a0m5ngeek8v5m98rq1o1c49.apps.googleusercontent.com'>
    <meta name='referrer' content='no-referrer-when-downgrade'>
    <title>Friend Library</title>
    <link rel='icon' type='image/x-con' href='resources/media/Elyse.png'>
    <link rel='stylesheet' type='text/css' href='resources/css/reset.css'>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.2.1/dist/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
    <link rel='stylesheet' type='text/css' href='resources/css/style.css'>
    <script src="https://kit.fontawesome.com/a230460b96.js" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
    
</head>

<body>

    <header>

    </header>

    <script type='text/javascript'>

      function testingView() {
        $('#login-page').css('display', 'none');
        $('main').css('display', 'inline-flex');
        $('#selected-book-container').css({
          display: 'inline-flex',
          alignItems: 'center'
        });
        document.getElementById('selected-status').innerText = 'Borrowed';
        document.getElementById('selected-status').setAttribute('class', 'status-tbr');

      }

      if (location.host !== 'ongaston.github.io') {
        $(window).on('load', testingView);
      }

    </script>

    <div id='login-page'>

      <h1 id='page-title'>Friend Library</h1>

      <button id='authorize-button' onclick="authorizeGoogleAccess()" class='button'>Login</button>

    </div>

    <span id='load-book'><i class='fa-solid fa-book-open fa-beat-fade fa-4x'></i></span>

    <main id='main'>

        <pre id='content'></pre>

        <div id='selected-book-container'>

          <div id='selected-cover-container'>

            <img id='selected-cover' src='resources/media/no-cover.png'>

          </div>

          <div id='selected-book-info-container'>

            <div id='selected-title-container'><h1 id='selected-title'>Book Title</h1><span class='status' id='selected-status'></span></div>
  
            <h2 id='selected-author'>Author</h2>
  

  
            <p class='selected-info' id='fiction-non-fiction'>Fiction</p>
            <p class='selected-info' id='tw'>TW: </p>
            <p class='selected-info' id='owners'>Owner(s): </p>

            <div id='selected-genres-container'>

              <h2 class='selected-section-title'>Genres:</h2>
              <div id='genre-container'>

                <!--<p class='selected-genre'>Historical</p>
                <p class='selected-genre'>Sci-Fi</p>
                <p class='selected-genre'>Dystopian</p>
                <p class='selected-genre'>Another Genre</p>-->

              </div>

            </div>
  
          </div>
          
          <div id='selected-book-ratings'>

            <h2 id='comments-title' class='selected-section-title'>Comments: </h2>
            <p id='comments'></p>

            <h2 class='selected-section-title'><a id='goodreads-link'>Goodreads Link<a id='goodreads-link'></a></h2>

          </div>

        </div>

        <div id='browse-container'>

          <div id='filter-bar-container'>

            <div id='filter-bar-content'>

              <div id='filter-container'>

                <p id='filter-label'>Filters<span id='plus-sign'><i class='fa-solid fa-plus'></i></span></p>

              </div>

              <div id='active-genre-container'></div>

              <div id='search-bar-container'>

                <input id='search-bar' type='search' placeholder='Search'>

              </div>

            </div>

          </div>

          <div id='book-list'>

            <!--<div id = 'test-book' class='book-container' data-title="cain's jawbone">

              <img class='book-cover' src='resources/media/test-cover.jpg'>

              <p class='book-title'>Cain's Jawbone</p>
              <p class='book-author'>Edward Powys Mathers</p>

            </div>-->

          </div>

        </div>

    </main>
    
    <!--create book elements-->
    <script type='text/javascript'>

      function normalizeString(normalize, trim) {

        let temp = normalize.split(' ');
        for (let i = 0; i < temp.length; i++) {
          temp[i] = temp[i][0].toUpperCase() + (temp[i].substring(1));
        }
        temp = temp.join(' ');

        if (temp.length >= 19 & trim) {

          let check = temp.trim().substring(0, 19);
          return check.trim().concat('...');

        }

        return temp.trim();
      }

      function clearBooks() {
        $('#book-list').empty();
      }

      function createBookElement(book) {

        let bookContainer = document.createElement('div');
        bookContainer.setAttribute('class', 'book-container');
        bookContainer.setAttribute('data-title', book.title);

        let bookCover = document.createElement('img');
        bookCover.setAttribute('class', 'book-cover');
        bookCover.setAttribute('src', book.cover);

        let bookTitle = document.createElement('p');
        bookTitle.setAttribute('class', 'book-title');
        bookTitle.innerText = normalizeString(book.title, true);
        
        let bookAuthor = document.createElement('p');
        bookAuthor.setAttribute('class', 'book-author');
        bookAuthor.innerText = normalizeString(book.author, true);

        document.getElementById('book-list').appendChild(bookContainer);
        bookContainer.appendChild(bookCover);
        bookContainer.appendChild(bookTitle);
        bookContainer.appendChild(bookAuthor);

        $(bookContainer).on('click', fillSelected);

      }

      function fillSelected() {

        let book = noCopyArray.find(e => {return (e.title == this.dataset.title)});

        document.getElementById('selected-cover').setAttribute('src', book.cover);
        document.getElementById('selected-title').innerText = normalizeString(book.title, false);
        document.getElementById('selected-author').innerText = normalizeString(book.author, false);
        if (book.status !== 'n') {
          document.getElementById('selected-status').setAttribute('class', 'status-' + (book.status));
          document.getElementById('selected-status').innerText = normalizeString(book.status, false);
        } else {
          document.getElementById('selected-status').innerText = '';
          document.getElementById('selected-status').setAttribute('class', 'status');
        }
        document.getElementById('fiction-non-fiction').innerText = normalizeString(book.type, false);
        if (book.tw !== 'n') {
          document.getElementById('tw').innerText = 'TW: ' + (book.tw);
        } else {
          document.getElementById('tw').innerText = 'TW: ';
        }
        document.getElementById('owners').innerText = 'Owner(s): ' + findOwners(book.title);
        if (book.comments !== 'n') {
          document.getElementById('comments').innerText = book.comments;
        } else {
          document.getElementById('comments').innerText = '';
        }

        if (book.goodreads !== 'n') {
          document.getElementById('goodreads-link').setAttribute('href', book.goodreads);
          document.getElementById('goodreads-link').innerText = 'Goodreads Link';
        } else {
          document.getElementById('goodreads-link').setAttribute('href', '');
          document.getElementById('goodreads-link').innerText = '';
        }

        $('#genre-container').empty();

        for (let i = 0; i < book.genres.length; i++) {

          let genreElement = document.createElement('p');
          genreElement.setAttribute('class', 'selected-genre');
          genreElement.innerText = normalizeString(book.genres[i], false);
          document.getElementById('genre-container').appendChild(genreElement);

          $(genreElement).on('click', function() {

            editFiltered(genreElement.innerText.toLowerCase());
            filterGenre();

          })

        }
        
        showSelected();
        $('html').delay(200).animate({
          scrollTop: 0
        })

      }

      //$('#test-book').on('click', fillSelected);

    </script>

    <!--Search bar-->
    <script type='text/javascript'>

      let searchBar = document.getElementById('search-bar');
      let searching = false;
      let bookList = document.getElementById('book-list');

      $('#search-bar').on('input', function() {

        if (searchBar.value.length == 0) {
          searching = false;
          clearBooks();
          let pageIndex = pageArray[Number(currentPage) - 1];
          console.log(pageIndex);
            for (let j = 0; j < pageIndex.length; j++) {

              createBookElement(pageIndex[j]);

            }

            addPageElements();

            if (currentPage == 1) {
              document.getElementById('previous-page').style.color = 'hsla(30, 10%, 40%, 1)';
            } else {
              document.getElementById('previous-page').style.color = 'hsla(30, 40%, 84%, 1)';
            }

            if (currentPage == pageArray.length) {
              document.getElementById('next-page').style.color = 'hsla(30, 10%, 40%, 1)';
            } else {
              document.getElementById('next-page').style.color = 'hsla(30, 40%, 84%, 1)';
            }

        } else if ((searchBar.value.length < 4 && searchBar.value.length > 0)) {
          searching = false;
          return;
        } else {

          if (!searching) {
            clearBooks();
          } else {
            searching = true;
          }

          $(bookList).remove('h1');

          let filteredGenres = getFiltered();

          for (let i = 0; i < bookList.children.length; i++) {

            if ((!(bookList.children[i].dataset.title.includes(searchBar.value.toLowerCase())) && !(bookList.children[i].children[2].innerText.includes(searchBar.value.toLowerCase())))) {
              $(bookList).remove(bookList.children[i]);
            }

            let book = noCopyArray.find(e => {return (e.title == bookList.children[i].dataset.title)});

            if (!(filteredGenres.every(e => {return book.genres.includes(e)}))) {
              $(bookList).remove(bookList.children[i]);
            }

          }

          for (let i = 0; i < noCopyArray.length; i++) {

            if ((!(noCopyArray[i].title.includes(searchBar.value.toLowerCase())) && !(noCopyArray[i].author.includes(searchBar.value.toLowerCase()))) && !(filteredGenres.every(e => {return noCopyArray[i].genres.includes(e)}))) {

              continue;

            } else {
              console.log(noCopyArray[i]);
              createBookElement(noCopyArray[i]);

            }

          }

          if (document.getElementById('book-list').children.length !== 0) {
            hideSelected();
          } else {
            let noResults = document.createElement('h1');
            noResults.setAttribute('id', 'no-results');
            noResults.innerText = 'No results for current search';
            $(bookList).append(noResults);
          }

        }
        

      })

    </script>

    <!--the to end and find owners-->
    <script type='text/javascript'>

      function theToEnd(title) {

        if (title.toLowerCase().substring(0,3) == 'the ') {

          return title.slice(4).concat(', the');

        } else {

          return title;

        }  

      }

      function findOwners(title) {
        let owners = [];
        for (let i = 0; i < bookArray.length; i++) {
          if (bookArray[i].title == title) {
            owners.push(bookArray[i].owner);
          }
        }
        return owners.join(' ');
      }

    </script>
 
    <!--inline toggle and hide login-->
    <script type='text/javascript'>

      function inlineToggle(obj) {
          if ($(obj).css('display') == 'none') {
              $(obj).slideToggle();
              $(obj).css({
                  display: 'inline-flex',
                  flexDirection: 'column',
                  alignItems: 'center'
              })
          } else if (obj.style.display == 'inline-flex') {
              $(obj).slideToggle();
          }
      }

      function hideLogin() {

        $('#login-page').fadeOut().animate({
          display: 'none'
        });

        let bookTop = (window.screen.availHeight / 2 - 32).toString().concat('px');
        setTimeout(e => {
          $('#load-book').css({
            display: 'block',
            top: bookTop
          });
        }, 400);

      }

      function displayMain() {
        inlineToggle(document.getElementById('main'));

        setTimeout(() => {
          $('#load-book').css({
            display: 'none'
          });
        }, 400)
      }

      function showSelected() {

        if ($('#selected-book-container').css('display') == 'none') {
          inlineToggle(document.getElementById('selected-book-container'));
          $('#selected-book-container').css('flex-direction', 'row');

        }

      }

      function hideSelected() {
        if ($('#selected-book-container').css('display') == 'inline-flex') {
          inlineToggle(document.getElementById('selected-book-container'));
        }
      }

    </script>

    <!--filter functions-->
    <script type='text/javascript'>

      let filteredGenres = [];

      function getFiltered() {
        return filteredGenres;
      }

      function editFiltered(genre) {
        if (filteredGenres.includes(genre)) {
          filteredGenres.splice(filteredGenres.indexOf(genre), (filteredGenres.indexOf(genre) + 1));
          for (let i = 0; i < document.getElementById('active-genre-container').children.length; i++) {
            if (document.getElementById('active-genre-container').children[i].innerText.toLowerCase() == genre) {
              document.getElementById('active-genre-container').removeChild(document.getElementById('active-genre-container').children[i]);
            }
          }
        } else {
          filteredGenres.push(genre);
          let newActiveGenre = document.createElement('p');
          newActiveGenre.setAttribute('class', 'selected-genre');
          newActiveGenre.innerText = normalizeString(genre);
          $('#active-genre-container').append(newActiveGenre);
        }
        console.log(filteredGenres);
      }

      function filterAlphabetical(a, b) {

        if (a.alphabeticalTitle.charCodeAt(0) < b.alphabeticalTitle.charCodeAt(0)) {
          return -1;
        }
        if (a.alphabeticalTitle.charCodeAt(0) > b.alphabeticalTitle.charCodeAt(0)) {
          return 1;
        }

        return 0;

      }

      function filterGenre() {

        if (filteredGenres.length == 0) {
          clearBooks();
          let pageIndex = pageArray[Number(currentPage) - 1];
            for (let j = 0; j < pageIndex.length; j++) {

              createBookElement(pageIndex[j]);

            }

            addPageElements();

            if (currentPage == 1) {
              document.getElementById('previous-page').style.color = 'hsla(30, 10%, 40%, 1)';
            } else {
              document.getElementById('previous-page').style.color = 'hsla(30, 40%, 84%, 1)';
            }

            if (currentPage == pageArray.length) {
              document.getElementById('next-page').style.color = 'hsla(30, 10%, 40%, 1)';
            } else {
              document.getElementById('next-page').style.color = 'hsla(30, 40%, 84%, 1)';
            }
        } 

        if (filteredGenres.length > 0) {

          clearBooks();

          $(bookList).remove('h1');

          for (let i = 0; i < bookList.children.length; i++) {

            let book = noCopyArray.find(e => {return (e.title == bookList.children[i].dataset.title)});

            if (!(filteredGenres.every(e => {return book.genres.includes(e)}))) {
              $(bookList).remove(bookList.children[i]);
            }

          }

          for (let i = 0; i < noCopyArray.length; i++) {

            if (filteredGenres.every(e => {return noCopyArray[i].genres.includes(e)})) {

              createBookElement(noCopyArray[i]);

            }

          }

          if (document.getElementById('book-list').children.length !== 0) {
            hideSelected();
          } else {
            let noResults = document.createElement('h1');
            noResults.setAttribute('id', 'no-results');
            noResults.innerText = 'No results for current search';
            $(bookList).append(noResults);
          }

        }

      }

    </script>

    <!--classes and objects-->
    <script type='text/javascript'>

      let taylorSheet;
      let ericaSheet;
      let emmaSheet;
      let livSheet;
      let brittanySheet;
      let haleySheet;
      let kennaSheet;
      let elyseSheet;
      let courtneySheet;
      let alainaSheet;

      function formatGenres(genres) {

          genres = genres.split(';');
          genres = genres.map(e => {return e.trim().toLowerCase()});
          return genres;

      }

      let testGenres = 'Historical Fiction;Sci-Fi; Romance';

      class Book {
          constructor(title, author, type, genres, status = 'N', seriesMember = 'N', comments = 'N', bookNumber = 'N', series = 'N', tw = 'N', cover = './resources/media/no-cover.png', owner, goodreads = 'n') {
              this.title = title.toLowerCase();
              this.author = author.toLowerCase();
              this.type = type.toLowerCase();
              this.genres = formatGenres(genres);
              this.status = status.toLowerCase();
              this.seriesMember = seriesMember.toLowerCase();
              this.comments = comments.toLowerCase();
              this.bookNumber = bookNumber.toLowerCase();
              this.series = series.toLowerCase();
              this.tw = tw.toLowerCase();
              this.cover = cover;
              this.alphabeticalTitle = theToEnd(this.title);
              this.owner = owner;
              this.goodreads = goodreads;
          }
      }

      let testBook = new Book('title', 'author', 'type', testGenres, 'stat', 'comments');


      class Series {
          constructor(title) {
              this.title = title.toLowerCase();
              this.books = [];
              this.alphabeticalTitle = theToEnd(this.title);
          }
          getBooks() {
              return this.books;
          }
          setBooks(value) {
              this.books.push(value);
          }
      }

      class Person {
          constructor(name, sheet) {
              this.name = name;
              this.sheet = sheet;
              this.bookshelf = name + "'s Bookshelf";
              this.books = [];
          }
          getSheet() {
              return this.sheet;
          }
          setSheet(value) {
              this.sheet = eval(value);
          }
      }

      let taylor = new Person("Taylor", 'taylorSheet');
      let erica = new Person("Erica", 'ericaSheet');
      let brittany = new Person("Brittany", 'brittanySheet');
      let emma = new Person("Emma", 'emmaSheet');
      let liv = new Person("Liv", 'livSheet');
      let haley = new Person("Haley", 'haleySheet');
      let kenna = new Person("Kenna", 'kennaSheet');
      let elyse = new Person("Elyse", 'elyseSheet');
      let courtney = new Person("Courtney", 'courtneySheet');
      let alaina = new Person("Alaina", 'alainaSheet');

      let peopleArray = [taylor, erica, emma, liv, brittany, haley, alaina, courtney, kenna, elyse];
      let bookArray = [];
      let seriesArray = [];
      let noCopyArray = [];

    </script>

    <!--gapi stuff-->
    <script type="text/javascript">
          let pageArray = [];

        // You should set your Google client ID and Google API key
          const GOOGLE_CLIENT_ID = '568492347305-j8vnjb6h2a0m5ngeek8v5m98rq1o1c49.apps.googleusercontent.com';
          const GOOGLE_API_KEY = 'AIzaSyASnWe7SMdFOyFdAiP-ksrKAeYkVwajbeo';
          //
    
          const DISCOVERY_DOC = 'https://sheets.googleapis.com/$discovery/rest?version=v4';
    
         // Authorization scope should be declared for spreadsheet handing
         // multiple scope can he included separated by space
          const SCOPES = 'https://www.googleapis.com/auth/spreadsheets.readonly';
    
          let tokenClient;
          let gapiInited = false;
          let gisInited = false;
          //document.getElementById('authorize_btn').style.visibility = 'hidden';
          //document.getElementById('signout_btn').style.visibility = 'hidden';
    
          /**
           * Callback after api.js is loaded.
           */
          function gapiLoaded() {
            gapi.load('client', intializeGapiClient);
          }
    
          /**
           * Callback after the Google API client is loaded. Loads the
           * discovery doc to initialize the API.
           */
          async function intializeGapiClient() {
            await gapi.client.init({
              apiKey: GOOGLE_API_KEY,
              discoveryDocs: [DISCOVERY_DOC],
            });
            gapiInited = true;
            maybeEnableButtons();
          }
    
          /**
           * Callback after Google Identity Services are loaded.
           */
          function gisLoaded() {
            tokenClient = google.accounts.oauth2.initTokenClient({
              client_id: GOOGLE_CLIENT_ID,
              scope: SCOPES,
              callback: '', // defined later
            });
            gisInited = true;
            maybeEnableButtons();
          }
    
          /**
           * Enables user interaction after all libraries are loaded.
           */
          function maybeEnableButtons() {
            if (gapiInited && gisInited) {
              //document.getElementById('authorize_btn').style.visibility = 'visible';
            }
          }
    
          /**
           *  Sign in the user upon button click.
           */
          function authorizeGoogleAccess() {
            tokenClient.callback = async (resp) => {
              if (resp.error !== undefined) {
                throw (resp);
              }
              hideLogin()
              await getBooks();
              await displayMain();
            };
    
            if (gapi.client.getToken() === null) {
              // Prompt the user to select a Google Account and ask for consent to share their data
              // when establishing a new session.
              tokenClient.requestAccessToken({prompt: 'consent'});
            } else {
              // Skip display of account chooser and consent dialog for an existing session.
              tokenClient.requestAccessToken({prompt: ''});
            }
          }
    
          /**
           *  Sign out the user upon button click.
           */
          function signoutGoogle() {
            const token = gapi.client.getToken();
            if (token !== null) {
              google.accounts.oauth2.revoke(token.access_token);
              gapi.client.setToken('');
              document.getElementById('content').innerText = '';
              //document.getElementById('authorize_btn').innerText = 'Authorize';
              //document.getElementById('signout_btn').style.visibility = 'hidden';
            }
          }
    
          /**
           * Print the names and majors of students in a sample spreadsheet:
           * https://docs.google.com/spreadsheets/d/1aSSi9jk2gBEHXOZNg7AV7bJj0muFNyPLYwh2GXThvas/edit
           */
          async function getBooks() {

            try {
              taylorSheet = await gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: '1HIfF-BjV1QrKhRusaQhtMzQbkKyHsAZsFLJHV7iquyM',
                range: "'Taylor\'s Bookshelf'!A:L",
              });
              ericaSheet = await gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: '1HIfF-BjV1QrKhRusaQhtMzQbkKyHsAZsFLJHV7iquyM',
                range: "'Erica\'s Bookshelf'!A:L",
              });
              emmaSheet = await gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: '1HIfF-BjV1QrKhRusaQhtMzQbkKyHsAZsFLJHV7iquyM',
                range: "'Emma\'s Bookshelf'!A:L",
              });
              livSheet = await gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: '1HIfF-BjV1QrKhRusaQhtMzQbkKyHsAZsFLJHV7iquyM',
                range: "'Liv\'s Bookshelf'!A:L",
              });
              brittanySheet = await gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: '1HIfF-BjV1QrKhRusaQhtMzQbkKyHsAZsFLJHV7iquyM',
                range: "'Brittany\'s Bookshelf'!A:L",
              });
              haleySheet = await gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: '1HIfF-BjV1QrKhRusaQhtMzQbkKyHsAZsFLJHV7iquyM',
                range: "'Haley\'s Bookshelf'!A:L",
              });
              kennaSheet = await gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: '1HIfF-BjV1QrKhRusaQhtMzQbkKyHsAZsFLJHV7iquyM',
                range: "'Kenna\'s Bookshelf'!A:L",
              });
              elyseSheet = await gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: '1HIfF-BjV1QrKhRusaQhtMzQbkKyHsAZsFLJHV7iquyM',
                range: "'Elyse\'s Bookshelf'!A:L",
              });
              courtneySheet = await gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: '1HIfF-BjV1QrKhRusaQhtMzQbkKyHsAZsFLJHV7iquyM',
                range: "'Courtney\'s Bookshelf'!A:L",
              });
              alainaSheet = await gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: '1HIfF-BjV1QrKhRusaQhtMzQbkKyHsAZsFLJHV7iquyM',
                range: "'Alaina\'s Bookshelf'!A:L",
              });
            } catch (err) {
              document.getElementById('content').innerText = err.message;
              return;
            }
            const range = taylorSheet.result;
            if (!range || !range.values || range.values.length == 0) {
              document.getElementById('content').innerText = 'No values found.';
              return;
            }
            /*console.log(range.values);
            console.log(ericaSheet.result.values);
            console.log(emmaSheet.result.values);
            console.log(livSheet.result.values);
            console.log(brittanySheet.result.values);
            console.log(haleySheet.result.values);
            console.log(kennaSheet.result.values);
            console.log(elyseSheet.result.values);*/

            taylorSheet = range.values;
            ericaSheet = ericaSheet.result.values;
            emmaSheet = emmaSheet.result.values;
            livSheet = livSheet.result.values;
            brittanySheet = brittanySheet.result.values;
            haleySheet = haleySheet.result.values;
            kennaSheet = kennaSheet.result.values;
            elyseSheet = elyseSheet.result.values;
            courtneySheet = courtneySheet.result.values;
            alainaSheet = alainaSheet.result.values;

            
            for (let i = 0; i < peopleArray.length; i++) {

                peopleArray[i].setSheet(peopleArray[i].getSheet());

                for (let j = 1; j < peopleArray[i].sheet.length; j++) {

                  if (!peopleArray[i].sheet[j].includes('Y')) {
                      let bookInfo = peopleArray[i].sheet[j];
                      let newBook =  new Book(bookInfo[0], bookInfo[1], bookInfo[2], bookInfo[3], bookInfo[4], bookInfo[5], bookInfo[6], bookInfo[7], bookInfo[8], bookInfo[9], bookInfo[10], peopleArray[i].name, bookInfo[11]);
                      bookArray.push(newBook);

                  } else {
                      let bookInfo = peopleArray[i].sheet[j];
                      let newBook = new Book(bookInfo[0], bookInfo[1], bookInfo[2], bookInfo[3], bookInfo[4], bookInfo[5], bookInfo[6], bookInfo[7], bookInfo[8], bookInfo[9], bookInfo[10], peopleArray[i].name, bookInfo[11]);
                      if (seriesArray.some((e) => {return e.title == newBook.series})) {
                          let found = seriesArray.find((e) => {return e.title == newBook.series});
                          found.setBooks(newBook);
                      } else {
                          let newSeries = new Series(newBook.series);
                          newSeries.setBooks(newBook);
                          seriesArray.push(newSeries);
                      }

                      bookArray.push(newBook);
                              
                      }


                }

            }

            console.log(seriesArray);
            bookArray.sort(filterAlphabetical);
            console.log(bookArray);

            for (let i = 0; i < bookArray.length; i++) {

              for (const [key, value] of Object.entries(bookArray[i])) {
                if (!value) {
                  Object.defineProperty(bookArray[i], key, {value: 'n'})
                }
              }

              if (noCopyArray.every((e => {return e.title !== bookArray[i].title}))) {
                noCopyArray.push(bookArray[i]);
              }
            }


            let numPages = Math.ceil(noCopyArray.length / 24);

            while (pageArray.length < numPages) {

              let newPage = [];
              switch (pageArray.length) {
                case 0:
                  newPage.push(noCopyArray.slice(0, 24));
                  break;
                default:
                  let lowerIndex = (pageArray.length * 24) + 1;
                  let upperIndex = (pageArray.length * 24) + 25;
                  newPage.push(noCopyArray.slice(lowerIndex, upperIndex))
                  break;
              }
              newPage = newPage[0];
              pageArray.push(newPage);

            }
            console.log(pageArray);
            console.log(noCopyArray);

            for (let i = 0; i < 24; i++) {

              createBookElement(noCopyArray[i]);

            }

            addPageElements();

          }

          let currentPage = 1;

          function getCurrentPage() {
            return currentPage;
          }

          function addPageElements() {

          let pageButtonContainer = document.createElement('nav');
          pageButtonContainer.setAttribute('id', 'page-button-container');
          $('#book-list').append(pageButtonContainer);

          let previousPage = document.createElement('span');
          previousPage.setAttribute('id', 'previous-page');
          previousPage.setAttribute('class', 'page-button');
          let previousSymbol = document.createElement('i');
          previousSymbol.setAttribute('class', 'fa-solid fa-chevron-left');
          $(previousPage).append(previousSymbol);
          $(pageButtonContainer).append(previousPage);

          $(previousPage).on('click', function() {

            if (currentPage !== 1) {

              let targetPageArray = pageArray[currentPage - 2];
              clearBooks();

              for (let i = 0; i < targetPageArray.length; i++) {

                createBookElement(targetPageArray[i]);

              }

              currentPage -= 1;

              addPageElements();
              $('html').delay(200).animate({
                    scrollTop: 0
              })

            }

            if (currentPage == 1) {
              previousPage.style.color = 'hsla(30, 10%, 40%, 1)';
            } else {
              previousPage.style.color = 'hsla(30, 40%, 84%, 1)';
            }

          })

          for (let i = 0; i < pageArray.length; i++) {

              let pageButton = document.createElement('div');
              pageButton.setAttribute('class', 'page-button');
              pageButton.innerHTML = (i + 1).toString();
              $(pageButtonContainer).append(pageButton);

              $(pageButton).on('click', function() {

                if (pageButton.innerText !== currentPage.toString()) {

                  clearBooks();
                  let pageIndex = pageArray[Number(pageButton.innerText) - 1];
                  for (let j = 0; j < pageIndex.length; j++) {

                    createBookElement(pageIndex[j]);

                  }
                  currentPage = Number(pageButton.innerText);

                  addPageElements();

                  if (currentPage == 1) {
                    previousPage.style.color = 'hsla(30, 10%, 40%, 1)';
                  } else {
                    previousPage.style.color = 'hsla(30, 40%, 84%, 1)';
                  }

                  if (currentPage == pageArray.length) {
                    nextPage.style.color = 'hsla(30, 10%, 40%, 1)';
                  } else {
                    nextPage.style.color = 'hsla(30, 40%, 84%, 1)';
                  }

                  $('html').delay(200).animate({
                    scrollTop: 0
                  })

                }

              })

          }

          let nextPage = document.createElement('span');
          nextPage.setAttribute('id', 'next-page');
          nextPage.setAttribute('class', 'page-button');
          let nextSymbol = document.createElement('i');
          nextSymbol.setAttribute('class', 'fa-solid fa-chevron-right');
          $(nextPage).append(nextSymbol);
          $(pageButtonContainer).append(nextPage);

          $(nextPage).on('click', function() {

            if (currentPage !== pageArray.length) {

              let targetPageArray = pageArray[currentPage];
              clearBooks();

              for (let i = 0; i < targetPageArray.length; i++) {

                createBookElement(targetPageArray[i]);

              }

              currentPage += 1;

              addPageElements();

              $('html').delay(200).animate({
                    scrollTop: 0
              })

              if (currentPage == pageArray.length) {
                  nextPage.style.color = 'hsla(30, 10%, 40%, 1)';
                } else {
                  nextPage.style.color = 'hsla(30, 40%, 84%, 1)';
                }

            }

          })

          for (let j = 0; j < pageButtonContainer.children.length; j++) {
            if (pageButtonContainer.children[j].innerText == currentPage) {
              pageButtonContainer.children[j].style.fontWeight = 'bold';
            } else {
              pageButtonContainer.children[j].style.fontWeight = 'normal';
            }
          }

          }



        
    </script>



    <script async defer src='https://apis.google.com/js/api.js' onload='gapiLoaded()'></script>
    <script async defer src='https://accounts.google.com/gsi/client'onload='gisLoaded()'></script>
    
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.6/dist/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.2.1/dist/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

</body>




</html>